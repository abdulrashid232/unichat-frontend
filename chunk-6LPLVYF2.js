import{a as Q}from"./chunk-LDGHQ7M7.js";import"./chunk-RUV7RGJV.js";import{$ as q,A as g,Aa as J,B as x,Ba as w,C as j,E as $,Ja as K,L as s,O as M,P as b,T as h,V as z,W as N,X as G,Z as v,_ as R,aa as o,ba as r,ca as d,d as F,da as D,ea as C,fa as m,g as O,ja as l,k as P,ka as k,la as p,pa as y,qa as _,ra as U,t as B,w as A,z as u,za as Y}from"./chunk-AWLQVQJC.js";function Z(i,t){if(i&1&&(o(0,"span",4),l(1),r()),i&2){let e=m();s(),k(e.text)}}var E=class i{size="medium";color="currentColor";text="Loading...";showText=!1;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=b({type:i,selectors:[["app-loading-spinner"]],inputs:{size:"size",color:"color",text:"text",showText:"showText"},decls:5,vars:15,consts:[[1,"flex","items-center","justify-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin"],["cx","12","cy","12","r","10","stroke-width","4",1,"opacity-25"],["d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"ml-3","text-gray-700"]],template:function(e,n){e&1&&(o(0,"div",0),x(),o(1,"svg",1),d(2,"circle",2)(3,"path",3),r(),h(4,Z,2,1,"span",4),r()),e&2&&(s(),G("h-5",n.size==="small")("w-5",n.size==="small")("h-10",n.size==="medium")("w-10",n.size==="medium")("h-16",n.size==="large")("w-16",n.size==="large"),s(),z("stroke",n.color),s(),z("fill",n.color),s(),v(n.showText?4:-1))},dependencies:[w],encapsulation:2})};function ee(i,t){if(i&1){let e=D();o(0,"div",0)(1,"div",1),d(2,"div",2),o(3,"span",3),l(4,"\u200B"),r(),o(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),x(),o(9,"svg",8),d(10,"path",9),r()(),j(),o(11,"div",10)(12,"h3",11),l(13),r(),o(14,"div",12)(15,"p",13),l(16),r()()()()(),o(17,"div",14)(18,"button",15),C("click",function(){u(e);let a=m();return g(a.onConfirm())}),l(19),r(),o(20,"button",16),C("click",function(){u(e);let a=m();return g(a.onCancel())}),l(21),r()()()()()}if(i&2){let e=m();s(13),p(" ",e.title," "),s(3),p(" ",e.message," "),s(3),p(" ",e.confirmButtonText," "),s(2),p(" ",e.cancelButtonText," ")}}var I=class i{title="Confirm Action";message="Are you sure you want to proceed?";confirmButtonText="Confirm";cancelButtonText="Cancel";isOpen=!1;confirm=new $;cancel=new $;onConfirm(){this.confirm.emit()}onCancel(){this.cancel.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=b({type:i,selectors:[["app-confirmation-dialog"]],inputs:{title:"title",message:"message",confirmButtonText:"confirmButtonText",cancelButtonText:"cancelButtonText",isOpen:"isOpen"},outputs:{confirm:"confirm",cancel:"cancel"},decls:1,vars:1,consts:[["aria-labelledby","modal-title","aria-modal","true",1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],["aria-hidden","true",1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-lg","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"sm:flex","sm:items-start"],[1,"mx-auto","flex-shrink-0","flex","items-center","justify-center","h-12","w-12","rounded-full","bg-red-100","sm:mx-0","sm:h-10","sm:w-10"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","aria-hidden","true",1,"h-6","w-6","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"mt-3","text-center","sm:mt-0","sm:ml-4","sm:text-left"],["id","modal-title",1,"text-lg","leading-6","font-medium","text-gray-900"],[1,"mt-2"],[1,"text-sm","text-gray-500"],[1,"bg-gray-50","px-4","py-3","sm:px-6","sm:flex","sm:flex-row-reverse"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-red-600","text-base","font-medium","text-white","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","sm:mt-0","sm:ml-3","sm:w-auto","sm:text-sm",3,"click"]],template:function(e,n){e&1&&h(0,ee,22,4,"div",0),e&2&&v(n.isOpen?0:-1)},dependencies:[w],encapsulation:2})};var V=class i{constructor(t){this.chatService=t}getChatHistory(){return this.chatService.loadChatHistory().pipe(P(t=>t.sessions||[]))}deleteChatSession(t){return this.chatService.deleteSession(t)}getSession(t){return this.chatService.getSessionById(t)}static \u0275fac=function(e){return new(e||i)(A(Q))};static \u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{dialogVisibleSubject=new O(!1);dialogConfigSubject=new O({});dialogVisible$=this.dialogVisibleSubject.asObservable();dialogConfig$=this.dialogConfigSubject.asObservable();resolveConfirmation;constructor(){}open(t={}){return this.dialogConfigSubject.next({title:t.title??"Confirm Action",message:t.message??"Are you sure you want to proceed?",confirmButtonText:t.confirmButtonText??"Confirm",cancelButtonText:t.cancelButtonText??"Cancel"}),this.dialogVisibleSubject.next(!0),new Promise(e=>{this.resolveConfirmation=e})}confirm(){this.dialogVisibleSubject.next(!1),this.resolveConfirmation&&(this.resolveConfirmation(!0),this.resolveConfirmation=void 0)}cancel(){this.dialogVisibleSubject.next(!1),this.resolveConfirmation&&(this.resolveConfirmation(!1),this.resolveConfirmation=void 0)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"})};var ne=(i,t)=>t.id;function oe(i,t){i&1&&(o(0,"div",5),d(1,"app-loading-spinner"),r())}function re(i,t){if(i&1&&(o(0,"div",6)(1,"div",9)(2,"div")(3,"p",10),l(4),r()()()()),i&2){let e=m();s(4),k(e.errorMessage)}}function se(i,t){i&1&&(o(0,"div",7)(1,"div",11),x(),o(2,"svg",12),d(3,"path",13),r(),j(),o(4,"h3",14),l(5,"No chat history"),r(),o(6,"p",15),l(7,"Start a new chat to ask questions!"),r(),o(8,"div",16)(9,"a",17),l(10," Start a new chat "),r()()()())}function ae(i,t){if(i&1&&(o(0,"span",25),l(1),r()),i&2){let e=m().$implicit;s(),p(" ",e.topic," ")}}function le(i,t){if(i&1){let e=D();o(0,"li",20),C("click",function(){let a=u(e).$implicit,c=m(2);return g(c.viewChatSession(a.id))})("keydown.enter",function(){let a=u(e).$implicit,c=m(2);return g(c.viewChatSession(a.id))}),o(1,"div",21)(2,"p",22),l(3),r(),o(4,"p",23),l(5),r(),o(6,"div",24)(7,"p"),l(8),y(9,"date"),r(),h(10,ae,2,1,"span",25),r()(),o(11,"div")(12,"button",26),C("click",function(a){let c=u(e).$implicit,f=m(2);return g(f.deleteChatSession(c.id,a))}),x(),o(13,"svg",27),d(14,"path",28),r()()()()}if(i&2){let e=t.$implicit,n=m(2);s(3),p(" ",n.getChatTitle(e)," "),s(2),p(" ",n.getLastMessagePreview(e)," "),s(3),k(U(9,4,e.updatedAt,"medium")),s(2),v(e.topic?10:-1)}}function me(i,t){if(i&1&&(o(0,"div",7)(1,"ul",18),R(2,le,15,7,"li",19,ne),r()()),i&2){let e=m();s(2),q(e.chatSessions)}}var X=class i{constructor(t,e,n){this.historyService=t;this.router=e;this.dialogService=n}chatSessions=[];isLoading=!0;errorMessage=null;showDeleteConfirmation=!1;sessionToDelete=null;ngOnInit(){this.loadChatHistory()}loadChatHistory(){this.isLoading=!0,this.errorMessage=null,this.historyService.getChatHistory().subscribe({next:t=>{this.chatSessions=t||[],this.isLoading=!1},error:t=>{this.errorMessage=`Failed to load chat history: ${t.message}`,this.isLoading=!1}})}viewChatSession(t){this.router.navigate(["/chat"],{queryParams:{session:t}})}deleteChatSession(t,e){return F(this,null,function*(){e.stopPropagation(),(yield this.dialogService.open({title:"Delete Chat Session",message:"Are you sure you want to delete this chat session? This action cannot be undone.",confirmButtonText:"Delete",cancelButtonText:"Cancel"}))&&this.historyService.deleteChatSession(t).subscribe({next:()=>{this.chatSessions=this.chatSessions.filter(a=>a.id!==t)},error:a=>{this.errorMessage=`Failed to delete chat session: ${a.message}`}})})}getChatTitle(t){if(t.title)return t.title;if(t.messages&&t.messages.length>0){let e=t.messages.find(n=>n.sender==="user");if(e)return e.text.substring(0,50)+(e.text.length>50?"...":"")}return"Untitled Chat"}getLastMessagePreview(t){if(!t.messages||t.messages.length===0)return"No messages";let e=t.messages[t.messages.length-1];return`${e.sender==="user"?"You":"AI"}: ${e.text.substring(0,60)}${e.text.length>60?"...":""}`}static \u0275fac=function(e){return new(e||i)(M(V),M(K),M(L))};static \u0275cmp=b({type:i,selectors:[["app-history"]],decls:16,vars:16,consts:[[1,"min-h-screen","bg-gray-50"],[1,"bg-white","shadow-sm"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-4"],[1,"text-xl","font-semibold","text-gray-900"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"flex","justify-center","py-12"],[1,"bg-red-50","border-l-4","border-red-500","p-4","mb-4"],[1,"bg-white","shadow","overflow-hidden","sm:rounded-lg"],[3,"confirm","cancel","isOpen","title","message","confirmButtonText","cancelButtonText"],[1,"flex"],[1,"text-sm","text-red-700"],[1,"px-4","py-12","flex","flex-col","items-center","justify-center","text-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"],[1,"mt-2","text-lg","font-medium","text-gray-900"],[1,"mt-1","text-gray-500"],[1,"mt-6"],["routerLink","/chat",1,"btn","btn-primary"],[1,"divide-y","divide-gray-200"],[1,"px-4","py-4","flex","items-center","justify-between","hover:bg-gray-50","cursor-pointer"],[1,"px-4","py-4","flex","items-center","justify-between","hover:bg-gray-50","cursor-pointer",3,"click","keydown.enter"],[1,"min-w-0","flex-1"],[1,"text-sm","font-medium","text-gray-900","truncate"],[1,"mt-1","text-sm","text-gray-500","truncate"],[1,"mt-2","flex","items-center","text-xs","text-gray-500"],[1,"ml-2","px-2","py-0.5","rounded-full","bg-blue-100","text-blue-800"],["type","button",1,"inline-flex","items-center","p-1","border","border-transparent","rounded-full","shadow-sm","text-white","bg-red-600","hover:bg-red-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"]],template:function(e,n){if(e&1&&(o(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),l(4,"Chat History"),r()()(),o(5,"main",4),h(6,oe,2,0,"div",5)(7,re,5,1,"div",6)(8,se,11,0,"div",7)(9,me,4,0,"div",7),r()(),o(10,"app-confirmation-dialog",8),y(11,"async"),y(12,"async"),y(13,"async"),y(14,"async"),y(15,"async"),C("confirm",function(){return n.dialogService.confirm()})("cancel",function(){return n.dialogService.cancel()}),r()),e&2){let a,c,f,S,T;s(6),v(n.isLoading?6:n.errorMessage?7:n.chatSessions.length===0?8:9),s(4),N("isOpen",(a=_(11,6,n.dialogService.dialogVisible$))!==null&&a!==void 0?a:!1)("title",(c=(c=_(12,8,n.dialogService.dialogConfig$))==null?null:c.title)!==null&&c!==void 0?c:"Confirm")("message",(f=(f=_(13,10,n.dialogService.dialogConfig$))==null?null:f.message)!==null&&f!==void 0?f:"Are you sure?")("confirmButtonText",(S=(S=_(14,12,n.dialogService.dialogConfig$))==null?null:S.confirmButtonText)!==null&&S!==void 0?S:"Confirm")("cancelButtonText",(T=(T=_(15,14,n.dialogService.dialogConfig$))==null?null:T.cancelButtonText)!==null&&T!==void 0?T:"Cancel")}},dependencies:[w,Y,J,E,I],encapsulation:2})};export{X as HistoryComponent};
