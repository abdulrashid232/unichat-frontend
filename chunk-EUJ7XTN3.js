import{a as k}from"./chunk-Z75ISNR3.js";import{b as w}from"./chunk-MI5SW7QG.js";import{a as F,b as u,c as b,d as E,e as L,f as T,g as q,h as N,i as A,j as I}from"./chunk-IE3VFMC2.js";import{a as j}from"./chunk-RUV7RGJV.js";import{B as _,Ba as C,Ja as S,Ka as y,L as l,O as s,P as h,T as d,W as f,Z as p,aa as r,ba as a,ca as g,ea as x,fa as v,ja as n}from"./chunk-AWLQVQJC.js";function P(i,t){i&1&&n(0," Email is required ")}function R(i,t){i&1&&n(0," Please enter a valid email address ")}function D(i,t){if(i&1&&(r(0,"div",8),d(1,P,1,0)(2,R,1,0),a()),i&2){let e,o=v();l(),p((e=o.loginForm.get("email"))!=null&&e.hasError("required")?1:(e=o.loginForm.get("email"))!=null&&e.hasError("email")?2:-1)}}function M(i,t){i&1&&n(0," Password is required ")}function V(i,t){i&1&&n(0," Password must be at least 6 characters ")}function B(i,t){if(i&1&&(r(0,"div",8),d(1,M,1,0)(2,V,1,0),a()),i&2){let e,o=v();l(),p((e=o.loginForm.get("password"))!=null&&e.hasError("required")?1:(e=o.loginForm.get("password"))!=null&&e.hasError("minlength")?2:-1)}}function z(i,t){i&1&&(_(),r(0,"svg",15),g(1,"circle",16)(2,"path",17),a(),n(3," Signing in... "))}function U(i,t){i&1&&n(0," Sign in ")}var G=class i{constructor(t,e,o,m,c){this.fb=t;this.authService=e;this.router=o;this.toastService=m;this.errorFormatter=c;this.loginForm=this.fb.group({email:["",[u.required,u.email]],password:["",[u.required,u.minLength(6)]]})}loginForm;isLoading=!1;onSubmit(){if(this.loginForm.invalid)return;this.isLoading=!0;let{email:t,password:e}=this.loginForm.value;this.authService.login(t,e).subscribe({next:()=>{this.isLoading=!1,this.toastService.success("Login successful!"),this.router.navigate(["/chat"])},error:o=>{this.isLoading=!1,this.toastService.error(this.errorFormatter.formatError(o,"Login failed"))}})}formatErrorMessage(t){if(!t)return"An unknown error occurred";if(t.status===401)return"Invalid email or password";if(t.status===404)return"Account not found. Please check your email";let e="Login failed";return typeof t=="string"?e=t:t.message?e=t.message:t.error?.message&&(e=t.error.message),e=e.replace("Error: ","").replace(/^[a-z]/,o=>o.toUpperCase()),e}static \u0275fac=function(e){return new(e||i)(s(A),s(w),s(S),s(j),s(k))};static \u0275cmp=h({type:i,selectors:[["app-login"]],decls:28,vars:5,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gray-50","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"mt-6","text-center","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-center","text-sm","text-gray-600"],[1,"mt-8","space-y-6",3,"ngSubmit","formGroup"],[1,"rounded-md","shadow-sm","space-y-4"],["for","email",1,"form-label"],["id","email","name","email","type","email","formControlName","email","placeholder","Email address","required","",1,"form-input"],[1,"form-error"],["for","password",1,"form-label"],["id","password","name","password","type","password","formControlName","password","placeholder","Password","required","",1,"form-input"],["type","submit",1,"btn","btn-primary","w-full","flex","justify-center",3,"disabled"],[1,"text-sm","text-center"],[1,"text-gray-600"],["routerLink","/register",1,"font-medium","text-primary","hover:text-primary-dark","cursor-pointer"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,o){if(e&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),n(4," Sign in to UniChat "),a(),r(5,"p",3),n(6," Your university AI chat assistant "),a()(),r(7,"form",4),x("ngSubmit",function(){return o.onSubmit()}),r(8,"div",5)(9,"div")(10,"label",6),n(11,"Email address"),a(),g(12,"input",7),d(13,D,3,1,"div",8),a(),r(14,"div")(15,"label",9),n(16,"Password"),a(),g(17,"input",10),d(18,B,3,1,"div",8),a()(),r(19,"div")(20,"button",11),d(21,z,4,0)(22,U,1,0),a()(),r(23,"div",12)(24,"p",13),n(25," Don't have an account? "),r(26,"a",14),n(27," Register here "),a()()()()()()),e&2){let m,c;l(7),f("formGroup",o.loginForm),l(6),p((m=o.loginForm.get("email"))!=null&&m.invalid&&((m=o.loginForm.get("email"))!=null&&m.touched)?13:-1),l(5),p((c=o.loginForm.get("password"))!=null&&c.invalid&&((c=o.loginForm.get("password"))!=null&&c.touched)?18:-1),l(2),f("disabled",o.loginForm.invalid||o.isLoading),l(),p(o.isLoading?21:22)}},dependencies:[C,I,L,F,b,E,N,T,q,y],encapsulation:2})};export{G as LoginComponent};
