import{a as G}from"./chunk-A3CVIHAC.js";import{b as E}from"./chunk-QXBRPBEX.js";import{a as b,b as c,c as R,d as P,e as T,f as q,g as N,h as A,i as L,j as M}from"./chunk-7D7WHRTW.js";import{a as j}from"./chunk-GJUVR4XO.js";import{H as y,Ma as w,T as l,W as f,Wa as S,Xa as F,Y as C,aa as s,da as v,ga as d,ja as a,ka as n,la as p,na as x,oa as h,ua as o}from"./chunk-EMO2IYOT.js";function k(r,e){r&1&&(a(0,"div",8),o(1,"Name is required"),n())}function I(r,e){r&1&&o(0," Email is required ")}function D(r,e){r&1&&o(0," Please enter a valid email address ")}function B(r,e){if(r&1&&(a(0,"div",8),s(1,I,1,0)(2,D,1,0),n()),r&2){let i,t=h();l(),d((i=t.registerForm.get("email"))!=null&&i.hasError("required")?1:(i=t.registerForm.get("email"))!=null&&i.hasError("email")?2:-1)}}function z(r,e){r&1&&o(0," Password is required ")}function U(r,e){r&1&&o(0," Password must be at least 6 characters ")}function H(r,e){if(r&1&&(a(0,"div",8),s(1,z,1,0)(2,U,1,0),n()),r&2){let i,t=h();l(),d((i=t.registerForm.get("password"))!=null&&i.hasError("required")?1:(i=t.registerForm.get("password"))!=null&&i.hasError("minlength")?2:-1)}}function O(r,e){r&1&&(a(0,"div",8),o(1,"Passwords do not match"),n())}function Y(r,e){r&1&&(y(),a(0,"svg",21),p(1,"circle",22)(2,"path",23),n(),o(3," Creating account... "))}function J(r,e){r&1&&o(0," Create account ")}var V=class r{constructor(e,i,t,m,u){this.fb=e;this.authService=i;this.router=t;this.toastService=m;this.errorFormatter=u;this.registerForm=this.fb.group({name:["",[c.required]],email:["",[c.required,c.email]],university:[""],password:["",[c.required,c.minLength(6)]],confirmPassword:["",[c.required]]},{validators:[this.passwordMatchValidator]})}registerForm;isLoading=!1;passwordMatchValidator(e){return e.get("password")?.value===e.get("confirmPassword")?.value?null:{mismatch:!0}}onSubmit(){if(this.registerForm.invalid)return;this.isLoading=!0;let{name:e,email:i,university:t,password:m}=this.registerForm.value;this.authService.register(e,i,m,t).subscribe({next:()=>{this.isLoading=!1,this.toastService.success("Account created successfully!"),this.router.navigate(["/chat"])},error:u=>{this.isLoading=!1,this.toastService.error(this.formatErrorMessage(u))}})}formatErrorMessage(e){if(!e)return"An unknown error occurred";if(e.status===409)return"An account with this email already exists";if(e.status===400)return"Please check your information and try again";let i="Registration failed";return typeof e=="string"?i=e:e.message?i=e.message:e.error?.message?i=e.error.message:Array.isArray(e.error?.errors)&&(i=e.error.errors.map(t=>t.message||t).join(". ")),i=i.replace("Error: ","").replace(/^[a-z]/,t=>t.toUpperCase()),i}static \u0275fac=function(i){return new(i||r)(f(L),f(E),f(S),f(j),f(G))};static \u0275cmp=C({type:r,selectors:[["app-register"]],decls:42,vars:7,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gray-50","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"mt-6","text-center","text-3xl","font-extrabold","text-gray-900"],[1,"mt-2","text-center","text-sm","text-gray-600"],[1,"mt-8","space-y-6",3,"ngSubmit","formGroup"],[1,"rounded-md","shadow-sm","space-y-4"],["for","name",1,"form-label"],["id","name","name","name","type","text","formControlName","name","placeholder","Full name","required","",1,"form-input"],[1,"form-error"],["for","email",1,"form-label"],["id","email","name","email","type","email","formControlName","email","placeholder","Email address","required","",1,"form-input"],["for","university",1,"form-label"],["id","university","name","university","type","text","formControlName","university","placeholder","Your university",1,"form-input"],["for","password",1,"form-label"],["id","password","name","password","type","password","formControlName","password","placeholder","Password","required","",1,"form-input"],["for","confirmPassword",1,"form-label"],["id","confirmPassword","name","confirmPassword","type","password","formControlName","confirmPassword","placeholder","Confirm password","required","",1,"form-input"],["type","submit",1,"btn","btn-primary","w-full","flex","justify-center",3,"disabled"],[1,"text-sm","text-center"],[1,"text-gray-600"],["routerLink","/login",1,"font-medium","text-primary","hover:text-primary-dark"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(i,t){if(i&1&&(a(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),o(4," Create your UniChat account "),n(),a(5,"p",3),o(6," Connect with your university AI assistant "),n()(),a(7,"form",4),x("ngSubmit",function(){return t.onSubmit()}),a(8,"div",5)(9,"div")(10,"label",6),o(11,"Full name"),n(),p(12,"input",7),s(13,k,2,0,"div",8),n(),a(14,"div")(15,"label",9),o(16,"Email address"),n(),p(17,"input",10),s(18,B,3,1,"div",8),n(),a(19,"div")(20,"label",11),o(21,"University (Optional)"),n(),p(22,"input",12),n(),a(23,"div")(24,"label",13),o(25,"Password"),n(),p(26,"input",14),s(27,H,3,1,"div",8),n(),a(28,"div")(29,"label",15),o(30,"Confirm password"),n(),p(31,"input",16),s(32,O,2,0,"div",8),n()(),a(33,"div")(34,"button",17),s(35,Y,4,0)(36,J,1,0),n()(),a(37,"div",18)(38,"p",19),o(39," Already have an account? "),a(40,"a",20),o(41," Sign in "),n()()()()()()),i&2){let m,u,g,_;l(7),v("formGroup",t.registerForm),l(6),d((m=t.registerForm.get("name"))!=null&&m.invalid&&((m=t.registerForm.get("name"))!=null&&m.touched)?13:-1),l(5),d((u=t.registerForm.get("email"))!=null&&u.invalid&&((u=t.registerForm.get("email"))!=null&&u.touched)?18:-1),l(9),d((g=t.registerForm.get("password"))!=null&&g.invalid&&((g=t.registerForm.get("password"))!=null&&g.touched)?27:-1),l(5),d((_=t.registerForm.get("confirmPassword"))!=null&&_.touched&&t.registerForm.hasError("mismatch")?32:-1),l(2),v("disabled",t.registerForm.invalid||t.isLoading),l(),d(t.isLoading?35:36)}},dependencies:[w,M,T,b,R,P,A,q,N,F],encapsulation:2})};export{V as RegisterComponent};
