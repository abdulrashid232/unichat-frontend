import{a as J,b as K,c as X,d as O,e as Z,f as D,g as ee,i as te,j as B}from"./chunk-IE3VFMC2.js";import{a as ie}from"./chunk-LDGHQ7M7.js";import"./chunk-RUV7RGJV.js";import{$ as k,A as h,Aa as F,B as x,Ba as _,C as $,E as M,Ha as Y,Ja as W,L as r,O as w,P as C,T as p,W as f,X as E,Z as d,_ as T,aa as o,ba as s,ca as u,da as v,ea as m,f as P,fa as c,ga as z,ha as q,ia as U,ja as a,ka as j,la as b,oa as A,p as S,pa as V,ra as I,ya as Q,z as g}from"./chunk-AWLQVQJC.js";var ne=[{id:"math",name:"Mathematics"},{id:"cs",name:"Computer Science"},{id:"phys",name:"Physics"},{id:"chem",name:"Chemistry"},{id:"bio",name:"Biology"},{id:"eng",name:"Engineering"},{id:"lit",name:"Literature"},{id:"hist",name:"History"},{id:"psyc",name:"Psychology"},{id:"econ",name:"Economics"}];var le=i=>["chat-bubble",i],ce=i=>({"bg-blue-100 text-blue-800":i});function me(i,t){if(i&1&&(o(0,"span",3),a(1),s()),i&2){let e=c();f("ngClass",A(2,ce,e.message.sender==="user")),r(),b(" ",e.message.topic," ")}}var G=class i{message;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["app-chat-bubble"]],inputs:{message:"message"},decls:10,vars:10,consts:[[3,"ngClass"],[1,"flex","items-center","space-x-2","mb-1"],[1,"text-xs","opacity-75"],[1,"text-xs","px-2","py-0.5","rounded-full","bg-gray-100",3,"ngClass"],[1,"text-xs","opacity-75","text-right","mt-1"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"span",2),a(3),s(),p(4,me,2,4,"span",3),s(),o(5,"p"),a(6),s(),o(7,"div",4),a(8),V(9,"date"),s()()),e&2&&(f("ngClass",A(8,le,n.message.sender==="user"?"chat-bubble-user":"chat-bubble-ai")),r(3),j(n.message.sender==="user"?"You":"UniChat AI"),r(),d(n.message.topic?4:-1),r(2),j(n.message.text),r(2),b(" ",I(9,5,n.message.timestamp,"shortTime")," "))},dependencies:[_,Q,F],styles:["[_nghost-%COMP%]{display:block}"]})};function de(i,t){i&1&&(x(),o(0,"svg",5),u(1,"circle",7)(2,"path",8),s())}function ue(i,t){i&1&&(x(),o(0,"svg",6),u(1,"path",9),s())}var L=class i{formGroup;isLoading=!1;sendMessage=new M;onSubmit(){this.formGroup.invalid||this.isLoading||this.sendMessage.emit()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["app-message-input"]],inputs:{formGroup:"formGroup",isLoading:"isLoading"},outputs:{sendMessage:"sendMessage"},decls:7,vars:3,consts:[[3,"ngSubmit","formGroup"],[1,"relative"],["type","text","formControlName","message","placeholder","Type your question here...",1,"form-input","pr-24"],[1,"absolute","inset-y-0","right-1","flex","items-center"],["type","submit",1,"btn","btn-primary","py-1","h-8","px-2","flex","items-center","justify-center",3,"disabled"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"]],template:function(e,n){e&1&&(o(0,"form",0),m("ngSubmit",function(){return n.onSubmit()}),o(1,"div",1),u(2,"input",2),o(3,"div",3)(4,"button",4),p(5,de,3,0,":svg:svg",5)(6,ue,2,0,":svg:svg",6),s()()()()),e&2&&(f("formGroup",n.formGroup),r(4),f("disabled",n.formGroup.invalid||n.isLoading),r(),d(n.isLoading?5:6))},dependencies:[_,B,Z,J,X,O,D,ee],styles:["[_nghost-%COMP%]{display:block}"]})};var ge=(i,t)=>t.id;function he(i,t){if(i&1&&a(0),i&2){let e=c();b(" ",e.selectedTopic.name," ")}}function fe(i,t){i&1&&a(0," Select Topic ")}function be(i,t){if(i&1){let e=v();o(0,"button",9),m("click",function(){let l=g(e).$implicit,y=c(2);return h(y.selectTopic(l))}),a(1),s()}if(i&2){let e=t.$implicit,n=c(2);E("bg-gray-100",(n.selectedTopic==null?null:n.selectedTopic.id)===e.id),r(),b(" ",e.name," ")}}function xe(i,t){if(i&1){let e=v();o(0,"div",8)(1,"button",10),m("click",function(){g(e);let l=c(2);return h(l.clearSelection())}),a(2," Clear Selection "),s()()}}function Ce(i,t){if(i&1){let e=v();o(0,"div",5),m("clickOutside",function(){g(e);let l=c();return h(l.isOpen=!1)}),o(1,"div",6),T(2,be,2,3,"button",7,ge),p(4,xe,3,0,"div",8),s()()}if(i&2){let e=c();r(2),k(e.topics),r(2),d(e.selectedTopic?4:-1)}}var N=class i{topics=[];selectedTopic=null;topicSelected=new M;isOpen=!1;selectTopic(t){this.selectedTopic=t,this.topicSelected.emit(t),this.isOpen=!1}clearSelection(){this.selectedTopic=null,this.topicSelected.emit(null),this.isOpen=!1}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=C({type:i,selectors:[["app-topic-selector"]],inputs:{topics:"topics",selectedTopic:"selectedTopic"},outputs:{topicSelected:"topicSelected"},decls:7,vars:2,consts:[[1,"relative"],["type","button",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"ml-2","-mr-0.5","h-4","w-4"],["fill-rule","evenodd","d","M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"origin-top-right","absolute","right-0","mt-2","w-56","rounded-md","shadow-lg","bg-white","ring-1","ring-black","ring-opacity-5","z-10"],[1,"origin-top-right","absolute","right-0","mt-2","w-56","rounded-md","shadow-lg","bg-white","ring-1","ring-black","ring-opacity-5","z-10",3,"clickOutside"],["role","menu","aria-orientation","vertical",1,"py-1"],["type","button","role","menuitem",1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","hover:text-gray-900",3,"bg-gray-100"],[1,"border-t","border-gray-100","mt-1","pt-1"],["type","button","role","menuitem",1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","hover:text-gray-900",3,"click"],["type","button","role","menuitem",1,"block","w-full","text-left","px-4","py-2","text-sm","text-red-600","hover:bg-gray-100",3,"click"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"button",1),m("click",function(){return n.isOpen=!n.isOpen}),p(2,he,1,1)(3,fe,1,0),x(),o(4,"svg",2),u(5,"path",3),s()(),p(6,Ce,5,1,"div",4),s()),e&2&&(r(2),d(n.selectedTopic?2:3),r(4),d(n.isOpen?6:-1))},dependencies:[_],styles:["[_nghost-%COMP%]{display:block}"]})};var ve=["chatContainer"],se=(i,t)=>t.id;function _e(i,t){if(i&1){let e=v();o(0,"button",26),m("click",function(){let l=g(e).$implicit,y=c(2);return y.onSessionSelected(l.id),h(y.isSessionMenuOpen=!1)}),a(1),o(2,"span",27),a(3),V(4,"date"),s()()}if(i&2){let e=t.$implicit,n=c(2);E("bg-gray-100",(n.currentSession==null?null:n.currentSession.id)===e.id),r(),b(" ",e.title," "),r(2),b(" ",I(4,4,e.lastMessageAt,"shortDate")," ")}}function ye(i,t){if(i&1){let e=v();o(0,"div",18),m("clickOutside",function(){g(e);let l=c();return h(l.isSessionMenuOpen=!1)}),o(1,"div",19),T(2,_e,5,7,"button",20,se),o(4,"div",21)(5,"button",22),m("click",function(){g(e);let l=c();return l.createNewSession(),h(l.isSessionMenuOpen=!1)}),o(6,"span",23),x(),o(7,"svg",24),u(8,"path",25),s(),a(9," New Conversation "),s()()()()()}if(i&2){let e=c();r(2),k(e.availableSessions)}}function Se(i,t){i&1&&(o(0,"div",14),x(),o(1,"svg",28),u(2,"path",29),s(),$(),o(3,"h3",30),a(4,"Welcome to UniChat! \u{1F44B}"),s(),o(5,"p",31),a(6," Hello! I'm your AI assistant. How can I help with your university studies today? "),s(),o(7,"div",32)(8,"p",33),a(9," You can ask me questions like: "),s(),o(10,"ul",34)(11,"li"),a(12,"Can you explain the concept of quantum entanglement?"),s(),o(13,"li"),a(14," Help me understand the difference between macroeconomics and microeconomics "),s(),o(15,"li"),a(16,"What are some techniques for effective academic writing?"),s(),o(17,"li"),a(18,"Explain the key periods of Renaissance art"),s()()(),o(19,"p",35),a(20," You can select a subject using the topic selector above to get more targeted responses. "),s()())}function we(i,t){if(i&1&&u(0,"app-chat-bubble",36),i&2){let e=t.$implicit;f("message",e)}}function Te(i,t){i&1&&(o(0,"div",37)(1,"div",38),u(2,"div",39)(3,"div",40)(4,"div",41),s(),o(5,"span",42),a(6,"AI is thinking..."),s()())}function ke(i,t){if(i&1&&(T(0,we,1,1,"app-chat-bubble",36,se),p(2,Te,7,0,"div",37)),i&2){let e=c();k(e.currentSession==null?null:e.currentSession.messages),r(2),d(e.isLoading?2:-1)}}var oe=class i{constructor(t,e,n,l){this.fb=t;this.chatService=e;this.route=n;this.router=l;this.messageForm=this.fb.group({message:["",[K.required]]})}chatContainer;messageForm;currentSession=null;availableSessions=[];topics=ne;selectedTopic=null;isLoading=!1;scrollToBottom=!1;isSessionMenuOpen=!1;destroy$=new P;currentSessionSubject=new P;ngOnInit(){this.chatService.loadChatHistory().subscribe(t=>{this.availableSessions=t.sessions||[],this.route.queryParams.pipe(S(this.destroy$)).subscribe(e=>{e.session&&this.availableSessions.length?this.loadSession(e.session):this.currentSession=null})}),this.chatService.currentSession$.pipe(S(this.destroy$)).subscribe(t=>{t&&(this.currentSession=t,this.scrollToBottom=!0)}),this.chatService.loading$.pipe(S(this.destroy$)).subscribe(t=>{this.isLoading=t}),this.chatService.sessions$.pipe(S(this.destroy$)).subscribe(t=>{this.availableSessions=t})}ngAfterViewChecked(){this.scrollToBottom&&(this.scrollChatToBottom(),this.scrollToBottom=!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadSession(t){if(!t){console.error("Cannot load session: No session ID provided");return}this.router.navigate(["/chat"],{queryParams:{session:t},replaceUrl:!0,skipLocationChange:!1}),this.chatService.getSessionById(t).subscribe({next:()=>{this.scrollToBottom=!0},error:e=>{console.error("Failed to load session:",e)}})}createNewSession(){this.currentSession=null,this.currentSessionSubject?.next(null),this.messageForm.get("message")?.setValue(""),this.router.navigate(["/chat"],{replaceUrl:!0,queryParams:{}})}onSendMessage(){if(this.messageForm.invalid||this.isLoading)return;let t=this.messageForm.get("message")?.value;if(!t)return;let e=this.selectedTopic?.name;this.messageForm.get("message")?.setValue(""),this.isLoading=!0,this.currentSession?this.chatService.sendMessageToSession(this.currentSession.id,t,e??this.currentSession.topic).subscribe({error:n=>{console.error("Error sending message to session:",n),this.isLoading=!1},complete:()=>{this.isLoading=!1}}):this.chatService.sendNewMessage(t,e).subscribe({next:n=>{n?.data?.session?.id&&this.router.navigate(["/chat"],{queryParams:{session:n.data.session.id},replaceUrl:!0}),this.scrollToBottom=!0,this.isLoading=!1},error:n=>{console.error("Error sending message:",n),this.isLoading=!1}}),this.scrollToBottom=!0}onTopicSelected(t){this.selectedTopic=t}onSessionSelected(t){this.loadSession(t)}scrollChatToBottom(){try{this.chatContainer.nativeElement.scrollTop=this.chatContainer.nativeElement.scrollHeight}catch(t){console.error("Error scrolling to bottom",t)}}static \u0275fac=function(e){return new(e||i)(w(te),w(ie),w(Y),w(W))};static \u0275cmp=C({type:i,selectors:[["app-chat"]],viewQuery:function(e,n){if(e&1&&z(ve,5),e&2){let l;q(l=U())&&(n.chatContainer=l.first)}},decls:22,vars:7,consts:[["chatContainer",""],[1,"h-screen","flex","flex-col","bg-gray-50"],[1,"bg-white","shadow-sm","mt-16"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-4","flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],[1,"text-xl","font-semibold","text-gray-900"],[1,"relative","inline-block","text-left"],["type","button","id","session-menu","aria-haspopup","true","aria-expanded","true",1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"ml-2","-mr-0.5","h-4","w-4"],["fill-rule","evenodd","d","M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"origin-top-right","absolute","right-0","mt-2","w-56","rounded-md","shadow-lg","bg-white","ring-1","ring-black","ring-opacity-5","z-10"],[3,"topicSelected","topics","selectedTopic"],[1,"flex-1","overflow-y-auto","px-4","py-6","mb-20"],[1,"max-w-3xl","mx-auto","space-y-4"],[1,"flex","flex-col","items-center","justify-center","h-full","text-center","text-gray-500","p-8"],[1,"border-t","border-gray-200","bg-white","p-4","fixed","bottom-0","left-0","right-0"],[1,"max-w-3xl","mx-auto"],[3,"sendMessage","formGroup","isLoading"],[1,"origin-top-right","absolute","right-0","mt-2","w-56","rounded-md","shadow-lg","bg-white","ring-1","ring-black","ring-opacity-5","z-10",3,"clickOutside"],["role","menu","aria-orientation","vertical",1,"py-1"],["type","button","role","menuitem",1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","hover:text-gray-900",3,"bg-gray-100"],[1,"border-t","border-gray-100","mt-1","pt-1"],["type","button","role","menuitem",1,"block","w-full","text-left","px-4","py-2","text-sm","text-blue-600","hover:bg-gray-100",3,"click"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6v6m0 0v6m0-6h6m-6 0H6"],["type","button","role","menuitem",1,"block","w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","hover:text-gray-900",3,"click"],[1,"text-xs","text-gray-500","ml-2"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"],[1,"text-lg","font-medium"],[1,"mt-1"],[1,"mt-4","bg-blue-50","p-4","rounded-lg","max-w-lg"],[1,"text-sm","text-blue-800","font-medium","mb-2"],[1,"text-sm","text-blue-700","list-disc","pl-5","space-y-1"],[1,"mt-4","text-sm"],[3,"message"],[1,"flex","items-center","space-x-2","chat-bubble","chat-bubble-ai"],[1,"flex","space-x-1"],[1,"w-2","h-2","rounded-full","bg-gray-500","animate-bounce"],[1,"w-2","h-2","rounded-full","bg-gray-500","animate-bounce",2,"animation-delay","0.2s"],[1,"w-2","h-2","rounded-full","bg-gray-500","animate-bounce",2,"animation-delay","0.4s"],[1,"text-sm","text-gray-600"]],template:function(e,n){if(e&1){let l=v();o(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4)(4,"h1",5),a(5,"AI Assistant"),s(),o(6,"div",6)(7,"button",7),m("click",function(){return g(l),h(n.isSessionMenuOpen=!n.isSessionMenuOpen)}),a(8),x(),o(9,"svg",8),u(10,"path",9),s()(),p(11,ye,10,0,"div",10),s()(),$(),o(12,"div")(13,"app-topic-selector",11),m("topicSelected",function(re){return g(l),h(n.onTopicSelected(re||null))}),s()()()(),o(14,"div",12,0)(16,"div",13),p(17,Se,21,0,"div",14)(18,ke,3,1),s()(),o(19,"div",15)(20,"div",16)(21,"app-message-input",17),m("sendMessage",function(){return g(l),h(n.onSendMessage())}),s()()()()}e&2&&(r(8),b(" ",(n.currentSession==null?null:n.currentSession.title)||"New Conversation"," "),r(3),d(n.isSessionMenuOpen?11:-1),r(2),f("topics",n.topics)("selectedTopic",n.selectedTopic),r(4),d(!(n.currentSession==null||n.currentSession.messages==null)&&n.currentSession.messages.length?18:17),r(4),f("formGroup",n.messageForm)("isLoading",n.isLoading))},dependencies:[_,F,B,O,D,G,L,N],encapsulation:2})};export{oe as ChatComponent};
